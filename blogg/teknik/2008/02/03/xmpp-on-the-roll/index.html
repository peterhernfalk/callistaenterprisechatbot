<!DOCTYPE html>
<html lang="sv-se">
<head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Callista Enterprise - seniora IT-arkitekter och systemutvecklare inom Java, öppen källkod, agil utveckling och systemintegration">
    <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
    <meta name="viewport" content="initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=no"/>

    <link rel="icon" href="../../../../../../images/icons/callista_favicon.svg" type="image/x-icon" />
    <link rel="shortcut icon" href="../../../../../../images/icons/callista_favicon.svg" type="image/x-icon" />
    <link rel="apple-touch-icon" href="../../../../../../images/icons/callista_favicon_160x160.png">

    <title>XMPP on the roll | Callista</title>

    <link rel="stylesheet" href="../../../../../../css/style.css%3Fv=1.css">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for callistaenterprise.se" href="../../../../../../feed.xml" />

    <!--[if lte IE 8]>
    <style>* { display: none !important; }</style>
    <meta http-equiv="refresh" content="0; url=/oldie/"/>
    <![endif]-->

    <script type="text/javascript" src="https://use.typekit.net/kig5egm.js"></script>
    <script type="text/javascript">
        try {
            Typekit.load({ async: true });
        } catch (e) {
        }
    </script>

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window,document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
     fbq('init', '804675599711872');
     fbq('track', 'PageView');
    </script>
    <noscript>
     <img height="1" width="1" src="https://www.facebook.com/tr?id=804675599711872&ev=PageView&noscript=1"/>
    </noscript>
    <!-- End Facebook Pixel Code -->

</head>
<body>

    <header class="ce-header" data-scroll="0">
    <nav>
        <img alt="menubg" class="ce-menu-icon" style="z-index:3; top: 0px; width: 50px; height: 100%;" src="../../../../../../images/icons/menu_background.png">
        <a class="ce-logotype" href="../../../../../../index.html" style="z-index: 2;">
            <img alt="Callista" style="max-width: 100%; height: auto;" src="../../../../../../images/logotype/callista_small2.svg">
        </a>
        <table>
            <tr>
                <td>
            <ul id="menu-primary" class="ce-menu-primary">
                
                    
                            <li><a href="../../../../../../om/index.html">Om oss</a></li>
                    
                
                    
                            <li><a href="../../../../../../erbjudanden.html">Erbjudanden</a></li>
                    
                
                    
                            <li><a href="../../../../../../event.html">Event</a></li>
                    
                
                    
                        
                            <li><a class="ce-active" href="../../../../../../blogg.html">Blogg</a></li>
                        
                    
                
                    
                            <li><a href="../../../../../../om/jobb/index.html">Jobba hos oss</a></li>
                    
                
            </ul>
                </td>

                <td>
            <ul class="ce-menu-secondary">
                
                <li><a href="../../../../../../english/index.html">English</a></li>
                
            </ul>
                </td>
            </tr>
        </table>
            <a id="menu" class="ce-menu-icon" href="index.html#" style="z-index: 4;">
                <img alt="Visa meny" src="../../../../../../images/icons/menu.png">
            </a>
            <a class="ce-search-icon" href="index.html#">
                <img alt="Sök" src="../../../../../../images/icons/search.png">
            </a>

        </table>
    </nav>
</header>


    <div class="ce-main">
        <section class="ce-start lazyImg">
    <article>
        <h1>Blogg</h1>
        <p class="ce-ingress">
            Här finns tekniska artiklar, presentationer och nyheter om arkitektur och systemutveckling. Håll dig uppdaterad, följ oss på <a class="ce-active" href="http://twitter.com/callistaent">Twitter</a>
        </p>
    </article>
</section>

<section class="ce-section">
    <div class="ce-content">
        
        

        
        

        <article class="ce-blog">
            <header>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <img alt="Callista medarbetare Niklas Gustavsson" src="../../../../../../assets/medarbetare/niklasgustavsson_mini.png">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <h2>
        <a href="index.html">XMPP on the roll</a>
        
        
    </h2>
    <h3>
        <time datetime="2008-02-03T00:00:00+00:00">
            03 February 2008
        </time>
        //
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        

        
        
        Niklas Gustavsson
        

        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </h3>
    
</header>




<p><a href="http://www.xmpp.org/">XMPP</a>, aka Jabber, is making great strides into the world of instant messaging. Since <a href="http://www.jeremie.com/blog/">Jeremie Miller</a> released the first version in 1998, it has been the obvious alternative for those preferring open protocols over the proprietary networks pushed by ICQ, AOL, MSN and others. With big guys like <a href="http://www.apple.com/se/server/macosx/features/ichat.html">Apple</a> and <a href="http://code.google.com/apis/talk/open_communications.html">Google</a> using XMPP it began making noise in the corporate world. Now, with AOL (one of the biggest IM network provider) <a href="http://florianjensen.com/2008/01/17/aol-adopting-xmpp-aka-jabber/">looking at XMPP</a>, the road to world dominance seems clear ahead.</p>

<p>So what’s in it for us, the application developers? One example is keeping an eye on our applications. XMPP provides two perfectly fitting concepts:</p>

<ul>
  <li>Presence - what modules are up and running</li>
  <li>Messages - communicate with your application</li>
</ul>

<p>Let’s have a look at a simple example. Note this is a demo code, quality code might use things like clever things like exception handling and external configuration. But for now, this will do.</p>

<p>First of all, you need two Jabber/GTalk accounts. Go <a href="http://www.jabber.org/user/userguide/#register">create them</a> (if you don’t already have a few), make sure they are buddies and get back here… back already? That was fast.</p>

<p>Now, let’s write a simple <a href="http://www.osgi.org/">OSGi</a> bundle that sends its presence based on the state in its life cycle. Feel free to imagining how this would work with Spring or EJB life cycle if that’s tickles you more. OSGi has what is called a <a href="http://www2.osgi.org/javadoc/r4/org/osgi/framework/BundleActivator.html">BundleActivator</a> that keeps track of when a bundle is started and stopped (that’s InitializingBean and DisposableBean for all of you in Spring land). Let’s create an implementation.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.osgi.framework.BundleActivator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Activator</span> <span class="kd">implements</span> <span class="nc">BundleActivator</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(</span><span class="nc">BundleContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">(</span><span class="nc">BundleContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Choose one of many XMPP clients available in Java. One of the easier is the <a href="http://www.igniterealtime.org/projects/smack/index.jsp">Smack client</a> from Jive^H^H^H^H Ignite Realtime, also available for <a href="http://www.mvnrepository.com/artifact/jivesoftware/smack">all your Maven needs</a>. Let’s create and connect one when our BundleActivator is created:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.jivesoftware.smack.ConnectionConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.XMPPConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.XMPPException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.packet.Message</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleActivator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Activator</span> <span class="kd">implements</span> <span class="nc">BundleActivator</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="nc">XMPPConnection</span> <span class="n">conn</span><span class="o">;</span>

  <span class="kd">private</span> <span class="nc">String</span> <span class="n">server</span> <span class="o">=</span> <span class="s">"jabber.org"</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">5222</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">userName</span> <span class="o">=</span> <span class="s">"myuser"</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"secret"</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">receiver</span> <span class="o">=</span> <span class="s">"myotheruser@gmail.com"</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Activator</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">XMPPException</span>  <span class="o">{</span>
    <span class="nc">ConnectionConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ConnectionConfiguration</span><span class="o">(</span><span class="n">server</span><span class="o">,</span> <span class="n">port</span><span class="o">);</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMPPConnection</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>I did tell you this is demo-quality code, right. If this were production code you would certainly want to inject that connection into your code rather than hard coding it. Fine, now, let’s show when the bundle goes active or is stopped by indicating our presence:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.jivesoftware.smack.ConnectionConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.XMPPConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.XMPPException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.packet.Message</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.packet.Presence</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleActivator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Activator</span> <span class="kd">implements</span> <span class="nc">BundleActivator</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Presence</span> <span class="no">AVAILABLE</span> <span class="o">=</span>
      <span class="k">new</span> <span class="nf">Presence</span><span class="o">(</span><span class="nc">Presence</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">AVAILABLE</span><span class="o">);</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Presence</span> <span class="no">UNAVAILABLE</span> <span class="o">=</span>
      <span class="k">new</span> <span class="nf">Presence</span><span class="o">(</span><span class="nc">Presence</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">UNAVAILABLE</span><span class="o">);</span>

  <span class="o">...</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(</span><span class="nc">BundleContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="n">userName</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">sendPacket</span><span class="o">(</span><span class="no">AVAILABLE</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">(</span><span class="nc">BundleContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">sendPacket</span><span class="o">(</span><span class="no">UNAVAILABLE</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We’re almost done. Why not get a message that tells us that the bundle has started and all is good. This is the complete code listing:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.jivesoftware.smack.ConnectionConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.XMPPConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.XMPPException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.packet.Message</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.jivesoftware.smack.packet.Presence</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleActivator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Activator</span> <span class="kd">implements</span> <span class="nc">BundleActivator</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Presence</span> <span class="no">AVAILABLE</span> <span class="o">=</span>
      <span class="k">new</span> <span class="nf">Presence</span><span class="o">(</span><span class="nc">Presence</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">AVAILABLE</span><span class="o">);</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Presence</span> <span class="no">UNAVAILABLE</span> <span class="o">=</span>
      <span class="k">new</span> <span class="nf">Presence</span><span class="o">(</span><span class="nc">Presence</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">UNAVAILABLE</span><span class="o">);</span>

  <span class="kd">private</span> <span class="nc">XMPPConnection</span> <span class="n">conn</span><span class="o">;</span>

  <span class="kd">private</span> <span class="nc">String</span> <span class="n">server</span> <span class="o">=</span> <span class="s">"jabber.org"</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">5222</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">userName</span> <span class="o">=</span> <span class="s">"myuser"</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"secret"</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">receiver</span> <span class="o">=</span> <span class="s">"myotheruser@gmail.com"</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Activator</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">XMPPException</span>  <span class="o">{</span>
    <span class="nc">ConnectionConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ConnectionConfiguration</span><span class="o">(</span><span class="n">server</span><span class="o">,</span> <span class="n">port</span><span class="o">);</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XMPPConnection</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(</span><span class="nc">BundleContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="n">userName</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">sendPacket</span><span class="o">(</span><span class="no">AVAILABLE</span><span class="o">);</span>

    <span class="nc">Message</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Message</span><span class="o">(</span><span class="n">receiver</span><span class="o">);</span>
    <span class="n">msg</span><span class="o">.</span><span class="na">setBody</span><span class="o">(</span><span class="s">"Bundle "</span> <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="na">getBundle</span><span class="o">().</span><span class="na">getSymbolicName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" started"</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">sendPacket</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="o">(</span><span class="nc">BundleContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">Message</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Message</span><span class="o">(</span><span class="n">receiver</span><span class="o">);</span>
    <span class="n">msg</span><span class="o">.</span><span class="na">setBody</span><span class="o">(</span><span class="s">"Bundle "</span> <span class="o">+</span> <span class="n">context</span><span class="o">.</span><span class="na">getBundle</span><span class="o">().</span><span class="na">getSymbolicName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" stopped"</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">sendPacket</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">sendPacket</span><span class="o">(</span><span class="no">UNAVAILABLE</span><span class="o">);</span>
    <span class="n">conn</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We’re done with coding. An OSGi bundle requires some extra attributes in the manifest but I won’t describe them in any detail here, go read any of the <a href="http://www.google.se/search?q=osgi+tutorial">OSGi tutorials</a> or the <a href="http://www2.osgi.org/Download/Release4V40">surprisingly readable specification</a> if you want to understand them.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Bundle-Version: 1.0
Bundle-SymbolicName: se.callistaenterprise.osgi.xmpp
Bundle-Name: XMPP-Bundle
Bundle-Vendor: Callista
Bundle-ManifestVersion: 2
Bundle-Activator: se.callistaenterprise.osgi.xmpp.Activator
Import-Package: org.osgi.framework,javax.net.ssl
Bundle-ClassPath: .,lib/smack-2.2.1.jar
</code></pre></div></div>

<p>Now package all of that into a JAR, including the Smack JAR, and fire up your favorite OSGi implementation. You do have a a favorite one, right?</p>

<p>For me, that means the <a href="http://felix.apache.org/">Apache Felix</a> <a href="http://felix.apache.org/site/apache-felix-usage-documentation.html">shell</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ java -jar bin/felix.jar

Welcome to Felix.
=================

Enter profile name: xmpp

DEBUG: WIRE: 1.0 -&gt; org.ungoverned.osgi.service.shell -&gt; 1.0
DEBUG: WIRE: 1.0 -&gt; org.osgi.service.startlevel -&gt; 0
DEBUG: WIRE: 1.0 -&gt; org.apache.felix.shell -&gt; 1.0
DEBUG: WIRE: 1.0 -&gt; org.osgi.framework -&gt; 0
DEBUG: WIRE: 1.0 -&gt; org.osgi.service.packageadmin -&gt; 0
DEBUG: WIRE: 2.0 -&gt; org.apache.felix.shell -&gt; 1.0
DEBUG: WIRE: 2.0 -&gt; org.osgi.framework -&gt; 0
DEBUG: WIRE: 3.0 -&gt; org.osgi.framework -&gt; 0
DEBUG: WIRE: 3.0 -&gt; org.osgi.service.obr -&gt; 3.0
DEBUG: WIRE: 3.0 -&gt; org.apache.felix.shell -&gt; 1.0
-&gt;
</code></pre></div></div>

<p>Start the bundle by running “start 4” and you should see the Jabber user getting online and get a message saying that everything is okay. Stop it with “stop 4” and you should get a message and see it go offline. Imagining having that with all your components and not having to depend on that monitoring system or wading through log files.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-&gt; install file:///path/to/project/xmpp-bundle-1.0.jar
Bundle ID: 4
-&gt; start 4
# Some error messages from Smack that you can happily ignore
-&gt; stop 4
</code></pre></div></div>

<p>For all you OSGi geeks, have a go at wrapping this code into a service that all your bundles can use. That’s what I do.</p>

<p>Seems useful? Got any ideas as to where you could use XMPP communicating with you?</p>









            <div class="ce-blog-thanks">
              Tack för att du läser Callistas blogg. <br>
              Hjälp oss att nå ut med information genom att dela nyheter och artiklar i ditt nätverk.<br>
            </div>

            


    
<div class="ce-blog-share">
    <a class="ce-blog-share-element social-twitter" href="https://twitter.com/intent/tweet?text=Xmpp On The Roll&url=https://callistaenterprise.se/blogg/teknik/2008/02/03/xmpp-on-the-roll/&via=callistaent&hashtags=" target="_blank" title="Share this post on Twitter"></a>
    <a class="ce-blog-share-element social-facebook" href="https://www.facebook.com/sharer/sharer.php?t=Xmpp On The Roll&u=https://callistaenterprise.se/blogg/teknik/2008/02/03/xmpp-on-the-roll/" target="_blank" title="Share this post on Facebook"></a>
    <a class="ce-blog-share-element social-linkedin" href="http://www.linkedin.com/shareArticle?mini=true&title=Xmpp On The Roll&url=https://callistaenterprise.se/blogg/teknik/2008/02/03/xmpp-on-the-roll/&source=http%3a%2f%2fzhangwenli.com" target="_blank" title="Share this post on LinkedIn"></a>
</div>
    
        </article>
    </div>
</section>


<section class="ce-section">
    <heading>
        <h1>Kommentarer</h1>
    </heading>
    <div class="ce-content">
        <div id="disqus_thread"></div>
        <script src="../../../../../../js/disqus.js"></script>
    </div>
</section>


    </div>

    <footer class="ce-footer">
    <div class="ce-wrapper">
        <nav class="ce-menu-footer-primary">
            <h2><a href="../../../../../../index.html">Callista</a></h2>
            <ul>
                
                <li><a href="../../../../../../om/index.html">Om oss</a></li>
                
                <li><a href="../../../../../../erbjudanden.html">Erbjudanden</a></li>
                
                <li><a href="../../../../../../event.html">Event</a></li>
                
                <li><a href="../../../../../../blogg.html">Blogg</a></li>
                
                <li><a href="../../../../../../om/jobb/index.html">Jobba hos oss</a></li>
                

                
                    
                        <li><a href="../../../../../../english/index.html">English</a></li>
                    
                
            </ul>
        </nav>
        <div class="ce-addresses">
            <div class="ce-address">
                <h2>Stockholm</h2>
                <address>
                    Drottninggatan 55<br>
                    111 21 Stockholm<br>
                    Tel:
                    <a href="tel:+468212142">
                        +46 8 21 21 42
                    </a>
                </address>
            </div>
            <div class="ce-address">
                <h2>Göteborg</h2>
                <address>
                    Fabriksgatan 13<br>
                    412 50 Göteborg<br>
                    Tel:
                    <a href="tel:+4631201918">
                        +46 31 20 19 18
                    </a>
                </address>
            </div>
        </div>
        <div class="ce-social">
            <h2>Följ oss</h2>
            <ul>
                <li>
                    <a href="http://twitter.com/callistaent">
                        <img alt="Twitters logotype" src="../../../../../../images/icons/twitter.png">
                        <span>@callistaent</span>
                    </a>
                </li>
            </ul>
        </div>
        <small>&copy; 2021 Callista Enterprise AB</small>
        <hr style="margin: 1em 0 2em 0">
        <div class="ce-footer-images">
          <div class="ce-footer-image">
            <a class="ce-raddabarnen" href="http://www.raddabarnen.se/foretag">
                <img alt="Callista är Rädda Barnens företagsvän 2021" src="../../../../../../images/logotype/rb_vanforetag_2021_large-sv.png">
            </a>
          </div>
        </div>
        <br>
        <div class="ce-footer-images">
          <div class="ce-footer-image">
            <a class="ce-di-gasell" href="http://www.di.se/gasell/">
              <img alt="Callista utsett till DI Gasell tre år i rad" src="../../../../../../images/logotype/di_gasell_180x194.png">
            </a>
          </div>
        </div>
    </div>
</footer>


    <script src="../../../../../../js/lib/jquery.min.js"></script>
    <script src="../../../../../../js/lib/owl.carousel.min.js"></script>
    <script src="../../../../../../js/lib/prismjs.min.js"></script>
    <script src="../../../../../../js/app.js"></script>
    <script src="../../../../../../js/analytics.js"></script>
    <script src="../../../../../../js/jobinterestsubmit.js"></script>

</body>
</html>
